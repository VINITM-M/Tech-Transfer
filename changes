import React, { useEffect, useState } from 'react';
import Navbar from '../Navbar';
import Sidebar from '../Sidebar';
import { Outlet } from 'react-router-dom';
import LogoutConfirmationCard from './LogoutConfirmationCard';
import { Dialog, DialogContent, IconButton, CircularProgress } from '@mui/material';
import CloseIcon from '@mui/icons-material/Close';

const Home = (props: any) => {
  const [sidebarOpen, setSidebarOpen] = useState(true);

  const [state, setState] = useState({
    logoutCardVisibility: '',
    optionsCard: false,
  });

  const [openDialog, setOpenDialog] = useState(false);
  const [minimized, setMinimized] = useState(false);

  useEffect(() => {
    if (props.loading) {
      setOpenDialog(true);
      setMinimized(false);
    } else {
      setOpenDialog(false);
      setMinimized(false);
    }
  }, [props.loading]);

  return (
    <>
      <Navbar onToggleSidebar={() => setSidebarOpen((p) => !p)} />
      <Sidebar hidden={!sidebarOpen} />

      <section
        className={`section_container ${
          sidebarOpen ? 'p_Container' : 'p_Container_full'
        }`}
      >
        <Outlet />
      </section>

      {props.loading && openDialog && !minimized && (
        <Dialog
          open
          onClose={() => setMinimized(true)}
          hideBackdrop
          PaperProps={{ className: 'loader-dialog-paper' }}
        >
          <IconButton
            onClick={() => setMinimized(true)}
            className="dialog-close-btn"
          >
            <CloseIcon />
          </IconButton>

          <DialogContent>
            <p className="loader-dialog-text">
              Connecting to Dochub, Updating the documents â€¦
            </p>

            <div className="dots-animation">
              <span></span><span></span><span></span><span></span>
            </div>
          </DialogContent>
        </Dialog>
      )}

      {props.loading && minimized && (
        <IconButton
          className="loader-restore-btn"
          onClick={() => {
            setMinimized(false);
            setOpenDialog(true);
          }}
        >
          <CircularProgress size={32} />
        </IconButton>
      )}

      <LogoutConfirmationCard
        logoutCardVisibility={state.logoutCardVisibility}
        cardClose={setState}
      />
    </>
  );
};

export default Home;


import React, { useEffect, useState } from 'react';
import companyLogo from '../assets/images/companyLogo.svg';
import homoLogo from '../assets/images/home1.svg';
import bars from '../assets/images/bars.png';
import { Link, useNavigate } from 'react-router-dom';
import ProfileCard from './Home/ProfileCard';

const Navbar = ({ onToggleSidebar }: any) => {
  const navigate = useNavigate();

  const [state, setState] = useState({
    username: '',
    tagName: '',
  });

  useEffect(() => {
    const userName = sessionStorage.getItem('username');
    const userRole = sessionStorage.getItem('userrole');
    const dept = sessionStorage.getItem('department');

    if (!userName) {
      sessionStorage.clear();
      navigate('/login');
      return;
    }

    let tag = userName;
    if (userRole === 'Process Owner') {
      if (dept === 'ARD') tag += ' | AR&D';
      if (dept === 'PRD') tag += ' | PR&D';
    }

    const [f, l] = userName.split(' ');
    setState({
      username: `${f[0]}${l ? ' ' + l[0] : ''}`.toUpperCase(),
      tagName: tag,
    });
  }, []);

  return (
    <>
      <nav className="header">
        <div className="row">
          <div className="col-8 d-flex align-items-center">

            <span className="bars" onClick={onToggleSidebar}>
              <img src={bars} alt="menu" />
            </span>

            <span className="logo">
              <img src={companyLogo} alt="logo" />
            </span>

            <Link to="/dashboard" className="homee">
              <span className="home">
                <img src={homoLogo} alt="Home" /> Home
              </span>
            </Link>

          </div>

          <div className="col d-flex justify-content-end align-items-center userDetails">
            <div className="admin">
              <div className="usermain">
                <p>{state.username}</p>
              </div>
              <span>{state.tagName}</span>
            </div>
          </div>
        </div>
      </nav>

      <ProfileCard />
    </>
  );
};

export default Navbar;


import React from "react";
import { Link } from "react-router-dom";
import folderIcon from "../assets/images/master.svg";
import adminIcon from "../assets/images/admin.svg";
import logoutIcon from "../assets/images/po.svg";
import msdsIcon from "../assets/images/msds.png";
import sharingIcon from "../assets/images/sharinghistory.svg";
import AnalyticsIcon from "@mui/icons-material/Analytics";

const Sidebar = ({ hidden }: { hidden: boolean }) => {
  const role = sessionStorage.getItem("userrole");

  return (
    <aside className={`p_sideNav ${hidden ? 'hidden' : ''}`}>
      <div className="main">

        {role === "System Owner-Admin" && (
          <>
            <Link to="/masters"><img src={folderIcon} /> Masters</Link>
            <Link to="/users"><img src={adminIcon} /> Users</Link>
            <Link to="/Configuration"><img src={folderIcon} /> Configuration</Link>
            <Link to="/SharingHistory"><img src={sharingIcon} /> Sharing History</Link>
            <Link to="/Tracker"><AnalyticsIcon /> Tracker</Link>
          </>
        )}

        {(role === "Process Owner" || role === "QA Approver") && (
          <>
            <Link to="/msds"><img src={msdsIcon} /> MSDS</Link>
            <Link to="/SharingHistory"><img src={sharingIcon} /> Sharing History</Link>
          </>
        )}
      </div>

      <button className="logout" data-bs-toggle="modal" data-bs-target="#logoutmodal">
        <img src={logoutIcon} /> Logout
      </button>
    </aside>
  );
};

export default Sidebar;


/* ---- SIDEBAR ---- */
.p_sideNav {
  width: 220px;
  position: fixed;
  top: 56px;
  left: 0;
  height: calc(100vh - 56px);
  background: #fff;
  box-shadow: 0 4px 12px rgba(0,0,0,.1);
  z-index: 10;
}

.p_sideNav.hidden {
  display: none;
}

.p_sideNav a {
  display: flex;
  gap: 10px;
  padding: 10px 16px;
  text-decoration: none;
  color: #333;
}

/* ---- CONTAINER ---- */
.p_Container {
  margin-left: 220px;
  padding-top: 90px;
}

.p_Container_full {
  margin-left: 0;
  padding-top: 90px;
}

/* ---- LOADER ---- */
.loader-dialog-paper {
  border-radius: 12px;
  padding: 20px;
}

.dots-animation {
  display: flex;
  gap: 6px;
  justify-content: center;
}

.dots-animation span {
  width: 10px;
  height: 10px;
  background: #00d084;
  border-radius: 50%;
  animation: bounce .6s infinite alternate;
}

@keyframes bounce {
  from { transform: translateY(0); }
  to { transform: translateY(-8px); }
}
